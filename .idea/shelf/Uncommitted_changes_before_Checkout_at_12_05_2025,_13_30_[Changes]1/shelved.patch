Index: app/build.gradle.kts
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>plugins {\n    alias(libs.plugins.android.application)\n}\n\nandroid {\n    namespace = \"org.beginningandroid.interactivetest\"\n    compileSdk = 35\n\n    defaultConfig {\n        applicationId = \"org.beginningandroid.interactivetest\"\n        minSdk = 24\n        targetSdk = 35\n        versionCode = 1\n        versionName = \"1.0\"\n\n        testInstrumentationRunner = \"androidx.test.runner.AndroidJUnitRunner\"\n    }\n\n    buildTypes {\n        release {\n            isMinifyEnabled = false\n            proguardFiles(\n                getDefaultProguardFile(\"proguard-android-optimize.txt\"),\n                \"proguard-rules.pro\"\n            )\n        }\n    }\n    compileOptions {\n        sourceCompatibility = JavaVersion.VERSION_11\n        targetCompatibility = JavaVersion.VERSION_11\n    }\n}\n\ndependencies {\n\n    implementation(libs.appcompat)\n    implementation(libs.material)\n    implementation(libs.activity)\n    implementation(libs.constraintlayout)\n    testImplementation(libs.junit)\n    androidTestImplementation(libs.ext.junit)\n    androidTestImplementation(libs.espresso.core)\n    implementation(libs.osmdroid)\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/build.gradle.kts b/app/build.gradle.kts
--- a/app/build.gradle.kts	(revision f7d10aaa4175cd6417ecf6207103f1a8c2d883b1)
+++ b/app/build.gradle.kts	(date 1747044402348)
@@ -32,7 +32,7 @@
 }
 
 dependencies {
-
+    implementation("com.google.mlkit:text-recognition:16.0.1")
     implementation(libs.appcompat)
     implementation(libs.material)
     implementation(libs.activity)
Index: app/src/main/java/org/beginningandroid/interactivetest/MainActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package org.beginningandroid.interactivetest;\n\nimport static androidx.core.content.ContextCompat.startActivity;\n\n\nimport android.graphics.Bitmap;\nimport android.os.Bundle;\nimport android.provider.MediaStore;\nimport android.view.View;\nimport android.widget.Button;\n//Bruges til at lave en Android Activity\nimport androidx.annotation.Nullable;\nimport androidx.appcompat.app.AppCompatActivity;\n//Bruges til at danne vores OSM kort bibliotek\nimport org.osmdroid.config.Configuration;\n//Indholder forskellige kort layouts\nimport org.osmdroid.tileprovider.tilesource.TileSourceFactory;\n//Klasse til at håndtere geopoint (tilføje punkter til kortet)\nimport org.osmdroid.util.GeoPoint;\n//Klasse til at fremvise kortet i appen\nimport org.osmdroid.views.MapView;\n//Klasse til at tilføje markører til kortet\nimport org.osmdroid.views.overlay.Marker;\nimport android.content.Intent;\nimport android.widget.ImageView;\nimport android.widget.Toast;\n\n//Definerer vores hoved aktivitet\npublic class MainActivity extends AppCompatActivity {\n private static final int REQUEST_CODE = 22;\n    Button bntpicture;\n    ImageView imageView;\n    @Override\n    protected void onCreate(Bundle savedInstanceState){\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n        bntpicture = findViewById(R.id.btnkamera_id);\n        imageView = findViewById(R.id.imageview1);\n\n        bntpicture.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                Intent cameraIntent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);\n                startActivityForResult(cameraIntent,REQUEST_CODE);\n\n            }\n        });\n    }\n\n    @Override\n    protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {\n        if (requestCode==REQUEST_CODE && resultCode == RESULT_OK)\n        {\n            Bitmap photo  = (Bitmap) data.getExtras().get(\"data\");\n            imageView.setImageBitmap(photo);\n        }\n        else {\n            Toast.makeText(this,\"Cancelled\",Toast.LENGTH_SHORT).show();\n            super.onActivityResult(requestCode, resultCode, data);\n        }\n    }\n}\n\n//deklarer et kort objekt\n /*   private MapView map;\n    @Override\n    //onCreate se lifecycle for app activities!\n    protected void onCreate(Bundle savedInstanceState) {\n        //Kalder vores superklasse\n        super.onCreate(savedInstanceState);\n        //Indlæser layout filen fra res/layout/activity_main.xml\n        setContentView(R.layout.activity_main);\n\n        // Konfigurer osmdroid (OpenStreetMap biblioteket)\n        Configuration.getInstance().setUserAgentValue(NOTIFICATION_SERVICE);\n\n        // Initialiser kortet\n        map = findViewById(R.id.map); //Finder kortet i layout filen (fra activity_main.xml), gennem ID\n        map.setTileSource(TileSourceFactory.MAPNIK); // Sætter layout til Standard OpenStreetMap layout\n        map.setMultiTouchControls(true); // Aktiver zoom og panorering, gennem multitouch\n\n        //  Sæt kortets startposition til København\n        GeoPoint startPoint = new GeoPoint(55.6761, 12.5683);\n        //Kan ændre zoom i starten\n        map.getController().setZoom(15.0);\n        //Sætter centrum på startpunktet\n        map.getController().setCenter(startPoint);\n\n        //Test, prøver at tilføje flere markører/punkter til kortet\n        GeoPoint supermarket1 = new GeoPoint(55.6760, 12.5680);\n\n        // Tilføj et markør til kortet\n        Marker marker = new Marker(map);\n        marker.setPosition(startPoint);\n        marker.setTitle(\"København\");\n        marker.setAnchor(Marker.ANCHOR_CENTER, Marker.ANCHOR_BOTTOM);\n        map.getOverlays().add(marker);\n\n        Marker marker2 = new Marker(map);\n        marker2.setPosition(supermarket1);\n        marker2.setTitle(\"Aarhus\");\n        marker2.setAnchor(Marker.ANCHOR_CENTER, Marker.ANCHOR_BOTTOM);\n        map.getOverlays().add(marker2);\n\n\n        // Gør København-markøren interaktiv\n        marker.setOnMarkerClickListener(new Marker.OnMarkerClickListener() {\n            @Override\n            public boolean onMarkerClick(Marker marker, MapView mapView) {\n                Intent intent = new Intent(MainActivity.this, MarkerDetailActivity.class);\n                intent.putExtra(\"location_name\", \"København\");\n                startActivity(intent);\n                return true; // Returnerer true for at indikere, at vi håndterer klik-handlingen\n            }\n        });\n\n        marker2.setOnMarkerClickListener(new Marker.OnMarkerClickListener() {\n            @Override\n            public boolean onMarkerClick(Marker marker, MapView mapView) {\n                Intent intent = new Intent(MainActivity.this, MarkerDetailActivity.class);\n                intent.putExtra(\"location_name\", \"Aarhus\");\n                startActivity(intent);\n                return true;\n            }\n        });\n\n\n    }\n\n}*/\n\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/org/beginningandroid/interactivetest/MainActivity.java b/app/src/main/java/org/beginningandroid/interactivetest/MainActivity.java
--- a/app/src/main/java/org/beginningandroid/interactivetest/MainActivity.java	(revision f7d10aaa4175cd6417ecf6207103f1a8c2d883b1)
+++ b/app/src/main/java/org/beginningandroid/interactivetest/MainActivity.java	(date 1747046696608)
@@ -3,14 +3,32 @@
 import static androidx.core.content.ContextCompat.startActivity;
 
 
+import android.app.Activity;
+import android.content.Intent;
 import android.graphics.Bitmap;
 import android.os.Bundle;
 import android.provider.MediaStore;
-import android.view.View;
 import android.widget.Button;
-//Bruges til at lave en Android Activity
+import android.widget.ImageView;
+import android.widget.TextView;
+import android.view.View;
+import android.widget.Toast;
 import androidx.annotation.Nullable;
 import androidx.appcompat.app.AppCompatActivity;
+
+import com.google.mlkit.vision.common.InputImage;
+import com.google.mlkit.vision.text.TextRecognition;
+import com.google.mlkit.vision.text.TextRecognizer;
+import com.google.mlkit.vision.text.latin.TextRecognizerOptions;
+import com.google.mlkit.vision.text.Text;
+
+import java.text.SimpleDateFormat;
+import java.util.Date;
+import java.util.Locale;
+import java.util.regex.*;
+//Bruges til at lave en Android Activity
+import androidx.activity.result.ActivityResult;
+import androidx.activity.result.ActivityResultLauncher;
 //Bruges til at danne vores OSM kort bibliotek
 import org.osmdroid.config.Configuration;
 //Indholder forskellige kort layouts
@@ -21,43 +39,97 @@
 import org.osmdroid.views.MapView;
 //Klasse til at tilføje markører til kortet
 import org.osmdroid.views.overlay.Marker;
-import android.content.Intent;
-import android.widget.ImageView;
-import android.widget.Toast;
 
 //Definerer vores hoved aktivitet
 public class MainActivity extends AppCompatActivity {
  private static final int REQUEST_CODE = 22;
-    Button bntpicture;
+ Button btnScan, btnHistory;
     ImageView imageView;
+    TextView resultText;
+    ReceiptDatabaseHelper dbHelper;
+
+ //   Button bntpicture;
     @Override
     protected void onCreate(Bundle savedInstanceState){
         super.onCreate(savedInstanceState);
         setContentView(R.layout.activity_main);
-        bntpicture = findViewById(R.id.btnkamera_id);
+
+        btnScan = findViewById(R.id.btnscanner_id);
+        btnHistory = findViewById(R.id.btn_history);
         imageView = findViewById(R.id.imageview1);
+        resultText = findViewById(R.id.result_text);
+        dbHelper = new ReceiptDatabaseHelper(this);
+
+        btnScan.setOnClickListener(v -> {
+            Intent cameraIntent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
+            startActivityForResult(cameraIntent,REQUEST_CODE);
+        });
 
-        bntpicture.setOnClickListener(new View.OnClickListener() {
+        btnHistory.setOnClickListener(v -> {
+            Intent intent = new Intent(MainActivity.this,HistoryActivity.class);
+            startActivity(intent);
+        });
+       // bntpicture = findViewById(R.id.btnscanner_id);
+
+       /* bntpicture.setOnClickListener(new View.OnClickListener() {
             @Override
             public void onClick(View v) {
                 Intent cameraIntent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
                 startActivityForResult(cameraIntent,REQUEST_CODE);
 
             }
-        });
+        });*/
     }
+
 
     @Override
     protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {
-        if (requestCode==REQUEST_CODE && resultCode == RESULT_OK)
+        if (requestCode==REQUEST_CODE && resultCode == RESULT_OK && data!=null)
         {
             Bitmap photo  = (Bitmap) data.getExtras().get("data");
             imageView.setImageBitmap(photo);
+            scanTextFromImage(photo);
         }
         else {
             Toast.makeText(this,"Cancelled",Toast.LENGTH_SHORT).show();
+        }
             super.onActivityResult(requestCode, resultCode, data);
+    }
+    private void scanTextFromImage(Bitmap bitmap){
+        InputImage image = InputImage.fromBitmap(bitmap,0);
+        TextRecognizer recognizer = TextRecognition.getClient(TextRecognizerOptions.DEFAULT_OPTIONS);
+
+        recognizer.process(image).addOnSuccessListener(visionText->{
+            String rawText = visionText.getText();
+            parseAndSavePantbon(rawText);
+        }).addOnFailureListener(e -> {
+            Toast.makeText(this,"Fejl i scanning",Toast.LENGTH_SHORT).show();
+        });
+    }
+    private void parseAndSavePantbon(String rawText){
+        Pattern totalPattern = Pattern.compile("(?m)^\\s*(\\d{1,4}[.,]\\d{2})\\s*$");
+        Matcher totalMatcher = totalPattern.matcher(rawText);
+
+        String total = "Ukendt";
+        while (totalMatcher.find()){
+            total = totalMatcher.group(1).replace(",",".");
         }
+        Pattern bottlePattern = Pattern.compile("(\\d+)\\s+Flasker?\\s+à\\s+(\\d+[.,]\\d{2})");
+        Matcher bottleMatcher = bottlePattern.matcher(rawText);
+        StringBuilder bottleSummary = new StringBuilder();
+        while (bottleMatcher.find()){
+            bottleSummary.append(bottleMatcher.group(1)).append("x").append(bottleMatcher.group(2).replace(",",".")).append("\n");
+        }
+        Pattern datePattern = Pattern.compile("(\\d{2}:\\d{2})\\s+(\\d{2}-[A-Z]{3}-\\d{4})");
+        Matcher dateMatcher = datePattern.matcher(rawText);
+        String time = "Ukendt", date = "Ukendt";
+        if (dateMatcher.find()){
+            time = dateMatcher.group(1);
+            time = dateMatcher.group(2);
+        }
+        dbHelper.insertReceipt(total,date,bottleSummary.toString());
+
+        resultText.setText("Dato:"+date+"\nTid:"+time+"\nTotal:"+total+"\n\nFlasker:\n"+bottleSummary);
     }
 }
 
Index: app/src/main/res/layout/activity_main.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\n<RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    android:layout_margin=\"10dp\"\n    >\n\n    <TextView\n        android:id=\"@+id/text\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:text=\"Klik på kamera\"\n        />\n\n    <Button\n        android:id=\"@+id/btnkamera_id\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"wrap_content\"\n        android:layout_below=\"@+id/text\"\n        android:text=\"Kamera\"\n        android:layout_centerHorizontal=\"true\"\n        />\n\n    <ImageView\n        android:id=\"@+id/imageview1\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"match_parent\"\n        android:layout_below=\"@+id/btnkamera_id\"\n        />\n    \n</RelativeLayout>\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_main.xml b/app/src/main/res/layout/activity_main.xml
--- a/app/src/main/res/layout/activity_main.xml	(revision f7d10aaa4175cd6417ecf6207103f1a8c2d883b1)
+++ b/app/src/main/res/layout/activity_main.xml	(date 1747042881834)
@@ -2,22 +2,24 @@
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
     android:layout_width="match_parent"
     android:layout_height="match_parent"
-    android:layout_margin="10dp"
+    android:layout_margin="5dp"
     >
 
     <TextView
         android:id="@+id/text"
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
-        android:text="Klik på kamera"
+        android:textSize="25dp"
+        android:text="Klik på scanner"
         />
 
     <Button
-        android:id="@+id/btnkamera_id"
+        android:id="@+id/btnscanner_id"
         android:layout_width="match_parent"
         android:layout_height="wrap_content"
         android:layout_below="@+id/text"
-        android:text="Kamera"
+        android:textSize="25dp"
+        android:text="Scan pantbon"
         android:layout_centerHorizontal="true"
         />
 
@@ -25,7 +27,7 @@
         android:id="@+id/imageview1"
         android:layout_width="match_parent"
         android:layout_height="match_parent"
-        android:layout_below="@+id/btnkamera_id"
+        android:layout_below="@+id/btnscanner_id"
         />
     
 </RelativeLayout>
Index: app/src/main/java/org/beginningandroid/interactivetest/ReceiptDatabaseHelper.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/org/beginningandroid/interactivetest/ReceiptDatabaseHelper.java b/app/src/main/java/org/beginningandroid/interactivetest/ReceiptDatabaseHelper.java
new file mode 100644
--- /dev/null	(date 1747049114376)
+++ b/app/src/main/java/org/beginningandroid/interactivetest/ReceiptDatabaseHelper.java	(date 1747049114376)
@@ -0,0 +1,20 @@
+package org.beginningandroid.interactivetest;
+
+import android.content.Context;
+import android.database.sqlite.SQLiteDatabase;
+import android.database.sqlite.SQLiteOpenHelper;
+import android.content.ContentValues;
+import android.database.Cursor;
+public class ReceiptDatabaseHelper extends SQLiteOpenHelper{
+    private static final String DATABASE_NAME = "recepits.db";
+    private static final int DATABASE_VERSION = 1;
+
+    public static final String TABLE_NAME = "pantbon";
+    public static final String COLUMN_ID = "_id";
+    public static final String COLUMN_TOTAL = "total";
+    public static final String COLUMN_DATE = "date";
+    public static final String COLUMN_TIME = "time";
+    public static final String COLUMN_BOTTLES = "bottles";
+
+    private static final String TABLE_CREATE = "CREATE TABLE"+TABLE_NAME+"("+COLUMN_ID+"INTEGER PRIMARY KEY AUTOINCREMENT,"+ COLUMN_TOTAL+"TEXT,"+COLUMN_DATE+"TEXT,"+COLUMN_TIME
+}
